import{b as R,r,u as L,a as f,c as _,h as U,j as a,G as n,d as h,M as d,B as W,D as Y}from"./index-CgMpkwRO.js";const F=()=>{const{enqueueSnackbar:v}=R(),[y,D]=r.useState([]),[x,C]=r.useState([]),[k,A]=r.useState([]),[$,T]=r.useState([]),E=L(),[t,m]=r.useState({staff_id:"",cls_id:"",cls_allocation_id:"",sub_id:"",academic_year:""}),[l,b]=r.useState({staff_id:"",cls_id:"",cls_allocation_id:"",sub_id:"",academic_year:""}),p=(e,c)=>{const s=c&&typeof c=="string"?c.trim():c;let i="";switch(e){case"staff_id":s||(i="please enter staff name");break;case"cls_id":s||(i="please enter cls_id");break;case"cls_allocation_id":s||(i="please enter cls_allocation_id");break;case"sub_id":s||(i="please enter sub_id");break;case"academic_year":s||(i="please enter academic_year");break}return i};r.useEffect(()=>{f.get(`${_.apiURL}/staffs/getStaffs`).then(e=>{T(e.data)}).catch(e=>{console.log("The error is :",e)})},[]),r.useEffect(()=>{f.get(`${_.apiURL}/clsAndSec/getClass`).then(e=>{D(e.data)}).catch(e=>{console.log("The error is :",e)})},[]),r.useEffect(()=>{m({...t,sec_id:""}),t.cls_id&&f.get(`${_.apiURL}/clsAndSec/getClsAndSecAllocationByClsId?cls_id=${t.cls_id}`).then(e=>{C(e.data),console.log("Sec Data :",x)}).catch(e=>{console.log("The error is :",e)})},[t.cls_id]),r.useEffect(()=>{m({...t,sub_id:""}),t.cls_allocation_id&&f.get(`${_.apiURL}/subject/getSubjects/${t.cls_allocation_id}`).then(e=>{A(e.data)}).catch(e=>{console.log("The error is :",e)})},[t.cls_id,t.cls_allocation_id]);const u=e=>{const{name:c,value:s}=e.target,i=p(c,s);b({...l,[c]:i}),m({...t,[c]:s})},o=parseInt(U().format("YYYY"),10),j=o-1,S=o+1,I=e=>{e.preventDefault();const c={};if(Object.keys(t).forEach(s=>{const i=t[s],g=p(s,i);g&&(c[s]=g)}),Object.keys(c).length>0){b(c);return}f.post(`${_.apiURL}/staffAllocation/postStaffAllocation`,t).then(s=>{alert(s.message),v("Staff alloated sucessfully",{variant:"success"}),E("/staffAllocationIndex")}).catch(s=>{console.log("Error save staff allocation")})};return a.jsxs("div",{children:[a.jsx("h1",{children:"Staff Allocation Form"}),a.jsxs(n,{container:!0,spacing:2,children:[a.jsx(n,{item:!0,xs:6,children:a.jsx(h,{select:!0,fullWidth:!0,label:"Select Class",name:"cls_id",error:!!l.cls_id,helperText:l.cls_id,onChange:u,value:t.cls_id,children:y.map(e=>a.jsx(d,{value:e.cls_id,children:e.cls_name}))})}),a.jsx(n,{item:!0,xs:6,children:a.jsx(h,{select:!0,fullWidth:!0,label:"Select Section",name:"cls_allocation_id",onChange:u,error:!!l.cls_allocation_id,helperText:l.cls_allocation_id,value:t.cls_allocation_id,children:x.map(e=>a.jsx(d,{value:e.cls_allocation_id,children:e.sec_name}))})}),a.jsx(n,{item:!0,xs:6,children:a.jsx(h,{select:!0,fullWidth:!0,label:"Select Subject",name:"sub_id",onChange:u,error:!!l.sub_id,helperText:l.sub_id,value:t.sub_id,children:k.map(e=>a.jsx(d,{value:e.sub_id,children:e.sub_name}))})}),a.jsx(n,{item:!0,xs:6,children:a.jsx(h,{select:!0,fullWidth:!0,label:"Select Staff",name:"staff_id",onChange:u,error:!!l.staff_id,helperText:l.staff_id,value:t.staff_id,children:$.map(e=>a.jsx(d,{value:e.staff_id,children:e.staff_name}))})}),a.jsx(n,{item:!0,xs:6,children:a.jsxs(h,{select:!0,fullWidth:!0,label:"Academic Year",name:"academic_year",onChange:u,error:!!l.academic_year,helperText:l.academic_year,value:t.academic_year,children:[a.jsxs(d,{value:`${j}-${o}`,children:[j,"-",o]}),a.jsxs(d,{value:`${o}-${S}`,children:[o,"-",S]})]})}),a.jsx(n,{item:!0,xs:12,display:"flex",justifyContent:"center",children:a.jsx(W,{variant:"contained",color:"success",startIcon:a.jsx(Y,{}),onClick:I,children:"Submit"})})]})]})};export{F as default};
