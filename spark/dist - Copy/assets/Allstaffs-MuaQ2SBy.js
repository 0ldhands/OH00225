import{r as f,a as _,c as S,j as e,G as c,d as x,M as j,B as b,D as M,s as R,k as O,t as W,m as I,L as F,J as V,n as G,o as N,p as B,q as z,v as Q,w,x as H,X as J,K,S as X,y as Y,z as Z,A as ee,E as te}from"./index-CgMpkwRO.js";function ae({data:s,onClose:D}){const[o,m]=f.useState({staff_id:s?s.staff_id:"",dept_id:s?s.dept_id:"",role_id:s?s.role_id:"",staff_name:s?s.staff_name:"",email:s?s.email:"",mobile:s?s.mobile:"",gender:s?s.gender:"",qualification:s?s.qualification:"",experience:s?s.experience:"",address:s?s.address:"",staff_img:s?s.staff_img:null}),[k,E]=f.useState([]),[T,y]=f.useState([]),[l,v]=f.useState({staff_id:"",dept_id:"",role_id:"",staff_name:"",email:"",mobile:"",gender:"",qualification:"",experience:"",address:"",staff_img:""});f.useEffect(()=>{_.get(`${S.apiURL}/department/getDept`).then(r=>{E(r.data)}).catch(r=>{console.log("Error fetching department data:",r)}),_.get(`${S.apiURL}/role/getRoleByDept?dept_id=${o.dept_id}`).then(r=>{y(r.data)}).catch(r=>{console.log("Error fetching role data:",r)})},[]);const d=r=>{const{name:t,value:i,files:n}=r.target,u=n?n[0]:i,g=p(t,u);v({...l,[t]:g}),m({...o,[t]:u})},C=r=>{r.preventDefault();const t={};if(Object.keys(o).forEach(n=>{const u=o[n],g=p(n,u);g&&(t[n]=g)}),Object.keys(t).length>0){v(t);return}const i=new FormData;Object.entries(o).forEach(([n,u])=>{u instanceof File?i.append(n,u,u.name):i.append(n,u)}),_.put(`${S.apiURL}/staffs/updateStaff/${s.staff_id}`,i,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{console.log("Success"),D()}).catch(n=>{console.log("Error:",n)})},p=(r,t)=>{const i=t&&typeof t=="string"?t.trim():t;let n="";switch(r){case"staff_id":i||(n="Please select Staff Name");break;case"dept_id":i||(n="Please select Department");break;case"role_id":i||(n="Please select Role");break;case"staff_name":i||(n="Please enter Staff Name");break;case"email":i||(n="Please enter Email");break;case"mobile":i||(n="Please enter Mobile");break;case"gender":i||(n="Please select Gender");break;case"qualification":i||(n="Please enter Qualification");break;case"experience":i||(n="Please enter Experience");break;case"address":i||(n="Please enter Address");break;case"staff_img":t||(n="Please upload Staff Image");break}return n};return e.jsxs("div",{children:[e.jsx("h1",{children:"Staff Update Form"}),e.jsx("form",{onSubmit:C,children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,select:!0,label:"Department",name:"dept_id",value:o.dept_id,onChange:d,variant:"outlined",error:!!l.dept_id,helperText:l.dept_id,children:k.map(r=>e.jsx(j,{value:r.dept_id,children:r.dept_name},r.dept_id))})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,select:!0,label:"Role",name:"role_id",value:o.role_id,onChange:d,variant:"outlined",error:!!l.role_id,helperText:l.role_id,children:T.map(r=>e.jsx(j,{value:r.role_id,children:r.role_name},r.role_id))})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,onChange:d,label:"Staff Name",variant:"outlined",name:"staff_name",value:o.staff_name,error:!!l.staff_name,helperText:l.staff_name})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,onChange:d,label:"Email",variant:"outlined",name:"email",value:o.email,error:!!l.email,helperText:l.email})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,onChange:d,label:"Mobile",variant:"outlined",name:"mobile",value:o.mobile,error:!!l.mobile,helperText:l.mobile})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(x,{fullWidth:!0,select:!0,label:"Gender",name:"gender",value:o.gender,onChange:d,variant:"outlined",error:!!l.gender,helperText:l.gender,children:[e.jsx(j,{value:"male",children:"Male"}),e.jsx(j,{value:"female",children:"Female"}),e.jsx(j,{value:"others",children:"Others"})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,onChange:d,label:"Qualification",variant:"outlined",name:"qualification",value:o.qualification,error:!!l.qualification,helperText:l.qualification})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,onChange:d,label:"Experience",variant:"outlined",name:"experience",value:o.experience,error:!!l.experience,helperText:l.experience})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,onChange:d,label:"Address",variant:"outlined",name:"address",value:o.address,error:!!l.address,helperText:l.address})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,onChange:d,InputLabelProps:{shrink:!0},type:"file",label:"Staff image",name:"staff_img",accept:"image/*",variant:"outlined",error:!!l.staff_img,helperText:l.staff_img})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(b,{variant:"contained",color:"success",startIcon:e.jsx(M,{}),type:"submit",children:"Submit"})})]})})]})}function ne(){const[s,D]=f.useState([]),[o,m]=f.useState(!1),[k,E]=f.useState(!1),[T,y]=f.useState(),[l,v]=f.useState(5),[d,C]=f.useState(1),[p,r]=f.useState("");f.useEffect(()=>{_.get(`${S.apiURL}/staffs/getStaffs`).then(a=>{D(a.data),console.log("Response data :",a.data)}).catch(a=>{console.log("Error:",a)})},[o,k]);const t=R(O)(({theme:a})=>({[`&.${W.head}`]:{backgroundColor:a.palette.common.black,color:a.palette.common.white},[`&.${W.body}`]:{fontSize:14}})),i=R(I)(({theme:a})=>({"&:nth-of-type(odd)":{backgroundColor:a.palette.action.hover},"&:last-child td, &:last-child th":{border:0}})),n=a=>{const h=s.find(P=>P.staff_id===a);h&&(y(h),m(!0))},u=a=>{_.delete(`${S.apiURL}/staffs/deleteStaff/${a}`).then(h=>{console.log("Deleted successfully :"),E(!0)}).catch(h=>{console.log("Error:",h)})},g=a=>{const h=parseInt(a.target.value,10);v(h),C(1)},U=(a,h)=>{C(h)},q=a=>{const h=p.toLowerCase();return Object.values(a).some(P=>P&&P.toString().toLowerCase().includes(h))},A=(d-1)*l,L=d*l,$=s.slice(A,L);return e.jsxs("div",{children:[e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:4,children:e.jsx(F,{to:"/addStaff",children:e.jsx(b,{variant:"contained",color:"primary",startIcon:e.jsx(V,{}),children:"Add"})})}),e.jsx(c,{item:!0,xs:4,children:e.jsx(x,{label:"Search",onChange:a=>r(a.target.value),value:p})}),e.jsx(c,{item:!0,xs:4,children:e.jsx(G,{children:e.jsxs(N,{value:l,onChange:g,children:[e.jsx("option",{value:5,children:"5 Per Page"}),e.jsx("option",{value:10,children:"10 Per Page"}),e.jsx("option",{value:15,children:"15 Per Page"}),e.jsx("option",{value:20,children:"20 Per Page"}),e.jsx("option",{value:0,children:"All Per Page"})]})})})]}),e.jsx(B,{component:z,className:"mt-3",children:e.jsxs(Q,{sx:{minWidth:700},"aria-label":"customized table",children:[e.jsx(w,{children:e.jsxs(I,{children:[e.jsx(t,{children:"S.no"}),e.jsx(t,{align:"right",children:"Staff name"}),e.jsx(t,{align:"right",children:"Email"}),e.jsx(t,{align:"right",children:"Mobile"}),e.jsx(t,{align:"right",children:"Gender"}),e.jsx(t,{align:"right",children:"Qualification"}),e.jsx(t,{align:"right",children:"Experience"}),e.jsx(t,{align:"right",children:"Address"}),e.jsx(t,{align:"right",children:"Department"}),e.jsx(t,{align:"right",children:"Role"}),e.jsx(t,{align:"right",children:"Actions"})]})}),e.jsx(H,{children:$.filter(q).map((a,h)=>e.jsxs(i,{children:[e.jsx(t,{component:"th",scope:"row",children:h+1}),e.jsx(t,{align:"right",children:a.staff_name}),e.jsx(t,{align:"right",children:a.email}),e.jsx(t,{align:"right",children:a.mobile}),e.jsx(t,{align:"right",children:a.gender}),e.jsx(t,{align:"right",children:a.qualification}),e.jsx(t,{align:"right",children:a.experience}),e.jsx(t,{align:"right",children:a.address}),e.jsx(t,{align:"right",children:a.dept_name}),e.jsx(t,{align:"right",children:a.role_name}),e.jsxs(t,{align:"right",children:[e.jsx(b,{variant:"contained",fullWidth:!0,color:"info",startIcon:e.jsx(J,{}),onClick:()=>n(a.staff_id),children:"Edit"}),e.jsx(b,{variant:"contained",fullWidth:!0,color:"error",startIcon:e.jsx(K,{}),onClick:()=>u(a.staff_id),children:"Delete"})]})]},h))})]})}),e.jsx(c,{container:!0,spacing:1,display:"flex",justifyContent:"center",className:"mt-3",children:e.jsx(X,{spacing:2,children:e.jsx(Y,{count:Math.ceil(s.length/l),page:d,onChange:U,variant:"outlined"})})}),e.jsxs(Z,{open:o,onClose:()=>m(!1),children:[e.jsx(ee,{children:e.jsx(ae,{data:T,onClose:()=>m(!1)})}),e.jsx(te,{children:e.jsx(b,{onClick:()=>m(!1),children:"Close"})})]})]})}export{ne as default};
