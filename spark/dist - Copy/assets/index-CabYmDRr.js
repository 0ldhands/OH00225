import{r,h as S,a as m,c as g,j as t,G as i,e as b,T as h,d as C,u as A,ai as $}from"./index-CgMpkwRO.js";import{a as v,b as w}from"./index-m6SEJXmv.js";import{M as I,g as k,_ as F}from"./constant-6J_ALP2n.js";import"./Divider-CUZDmsKr.js";const L=()=>{const[u,x]=r.useState([]),[j,y]=r.useState(""),[c,l]=r.useState(S().format("YYYY")),d=sessionStorage.getItem("staff_id");r.useEffect(()=>{(async()=>{try{const s=await m.get(`${g.apiURL}/dashboard/empAttendChart`,{params:{staff_id:d,year:c}});Array.isArray(s.data)?x(s.data):(x([]),console.error("Unexpected response format:",s.data))}catch(s){console.error("Error fetching attendance data:",s),x([])}})()},[c,d]),r.useEffect(()=>{m.get(`${g.apiURL}/staffs/getattenancedetails/${d}`).then(e=>{e.data&&e.data.name?y(e.data.name):y("")}).catch(e=>{console.log(e)})},[d]);const p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n={series:u.map(e=>e.count),options:{chart:{type:"pie",height:400},labels:u.map(e=>`${p[e.month-1]}: ${e.count}`),colors:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0","#546E7A","#26a69a","#D10CE8","#F77E53","#DADADA"],tooltip:{y:{formatter:function(e){return e}}}}};return t.jsx(t.Fragment,{children:t.jsxs(I,{children:[t.jsxs(i,{container:!0,spacing:k,children:[t.jsx(i,{item:!0,lg:8,md:12,sm:12,xs:12,children:t.jsxs(b,{textAlign:"center",children:[t.jsx(h,{variant:"h1",gutterBottom:!0,children:j}),t.jsx(h,{variant:"h2",children:"Employee Attendance"})]})}),t.jsx(i,{item:!0,lg:4,md:12,sm:12,xs:12,children:t.jsx(C,{label:"Enter Year",value:c,InputLabelProps:{shrink:!0},onChange:e=>l(e.target.value),fullWidth:!0})})]}),t.jsx(F,{options:n.options,series:n.series,type:"pie",height:400})]})})},R=L;function N(){const[u,x]=r.useState(""),[j,y]=r.useState([]),[c,l]=r.useState(null),[d,p]=r.useState("info");A();const n=sessionStorage.getItem("staff_id");r.useEffect(()=>{const s=async()=>{try{const a=await m.get(`${g.apiURL}/staffs/getStaffdash/${n}`);if(a.data&&a.data.length>0){const D=a.data[0];x(D.staff_name)}else console.error("Staff details are not in the expected format:",a.data)}catch(a){console.error("Error fetching staff details:",a)}},o=async()=>{try{const a=await m.get(`${g.apiURL}/staffs/getStaffdash/${n}`);a.data?y(a.data):console.error("Staff dashboard data is not in the expected format:",a.data)}catch(a){console.error("Error fetching staff dashboard data:",a)}};s(),o()},[n]);const e=async s=>{try{const a=new Date().toISOString().slice(0,19).replace("T"," "),D=s==="entry"?"empEntry":"empExit",E=await m.post(`${g.apiURL}/staffs/${D}/${n}`,{datetime:a});p("success"),l(E.data.message)}catch(o){console.error(`Error recording ${s}:`,o),o.response&&o.response.status===400?(p("warning"),l(o.response.data.message)):(p("error"),l(`Failed to record ${s}`))}};return t.jsxs(i,{container:!0,spacing:2,sx:{backgroundColor:"lightblue",padding:1,borderRadius:2,justifyContent:"center",position:"relative"},children:[c&&t.jsx($,{severity:d,onClose:()=>l(null),sx:{mb:2},children:c}),t.jsxs(h,{sx:f.header,children:["Welcome, ",u]}),t.jsxs(i,{container:!0,item:!0,xs:12,spacing:2,justifyContent:"space-around",alignItems:"center",children:[t.jsx(i,{item:!0,xs:12,md:6,lg:6,children:t.jsx(b,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:j.length>0?t.jsx(R,{sx:{width:"100%",height:"100%"}}):t.jsx(h,{children:"Loading..."})})}),t.jsxs(i,{item:!0,xs:6,md:1,lg:2.5,sx:f.entryExitContainer,children:[t.jsxs(b,{sx:f.box,onClick:()=>e("entry"),children:[t.jsx(h,{variant:"h6",sx:{mb:1},children:"Entry"}),t.jsx(v,{style:f.icon})]}),t.jsxs(b,{sx:f.box,onClick:()=>e("exit"),mt:2,children:[t.jsx(h,{variant:"h6",sx:{mb:1},children:"Exit"}),t.jsx(w,{style:f.icon})]})]})]})]})}const f={box:{fontWeight:"bold",height:"130px",width:"100%",borderRadius:"15px",padding:"10px",display:"flex",cursor:"pointer",flexDirection:"column",justifyContent:"center",alignItems:"center",transition:"transform 0.3s, background-color 0.3s",backgroundColor:"#9EA0D8","&:hover":{transform:"scale(1.05)",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)",backgroundColor:"#FFC0CB"}},link:{color:"white",textDecoration:"none"},icon:{fontSize:"40px",color:"#3f51b5",height:"70px",width:"70px"},logoutButton:{position:"absolute",backgroundColor:"black",color:"white",top:"20px",right:"10px"},header:{margin:"20px 0",textAlign:"center",fontWeight:"bold",fontSize:"24px"},entryExitContainer:{display:"flex",flexDirection:"column",alignItems:"center",animation:"fadeIn 1s ease-in-out"},"@keyframes fadeIn":{"0%":{opacity:0,transform:"translateY(-20px)"},"100%":{opacity:1,transform:"translateY(0)"}}};export{N as default};
